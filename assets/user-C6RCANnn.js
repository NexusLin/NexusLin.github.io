import{J as i,T as r,U as n,N as l,E as m,S as c}from"./index-B_mAkUH5.js";import{g as h,l as g}from"./login-D_PYrTNz.js";const u="/assets/avator-9Na8x4s3.png",k=i("user",{state:()=>({token:r(),name:"",avatar:"",roles:[],permissions:[],userId:""}),actions:{login(s){console.log("userInfo",s);const a=s.username.trim();return s.password,s.code,s.uuid,new Promise((e,t)=>{g(a).then(o=>{c(o.token),this.token=o.token,e()}).catch(o=>{t(o)})})},getInfo(){return new Promise((s,a)=>{h().then(e=>{if(e.code==200){const t=e.data,o=u;e.roles&&e.roles.length>0?(this.roles=e.roles,this.permissions=e.permissions):this.roles=["ROLE_DEFAULT"],this.name=t.username,this.avatar=t.avatar||o,this.userId=t.userId,s(e)}else l({title:"登录提示",message:e.message}),m.alert(e.message,"登录提示",{confirmButtonText:"OK",callback:t=>{n(),window.location.href="/login"}})}).catch(e=>{a(e)})})},logOut(){return new Promise((s,a)=>{this.token="",this.roles=[],this.permissions=[],n(),s()})}}});export{u as _,k as u};
