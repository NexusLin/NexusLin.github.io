import{_ as s,n as i,q as a,t as n}from"./chunks/theme-components.DDZ15eKn.js";import"./chunks/search-index.B-gvvmFQ.js";const h=JSON.parse('{"title":"â¤ æƒé™æ“ä½œæŒ‡ä»¤ï¼ˆv-hasPermiï¼‰","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"src/vue/vue3/vue3-æƒé™æŒ‰é’®.md","filePath":"src/vue/vue3/vue3-æƒé™æŒ‰é’®.md","lastUpdated":1747896538000}');const l=s({name:"src/vue/vue3/vue3-æƒé™æŒ‰é’®.md"},[["render",function(s,h,l,p,k,t){return a(),i("div",null,h[0]||(h[0]=[n('<h1 id="â¤-æƒé™æ“ä½œæŒ‡ä»¤-v-haspermi" tabindex="-1">â¤ æƒé™æ“ä½œæŒ‡ä»¤ï¼ˆv-hasPermiï¼‰ <a class="header-anchor" href="#â¤-æƒé™æ“ä½œæŒ‡ä»¤-v-haspermi" aria-label="Permalink to &quot;â¤ æƒé™æ“ä½œæŒ‡ä»¤ï¼ˆv-hasPermiï¼‰&quot;">â€‹</a></h1><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¸¸è§çš„æƒé™æ“ä½œæŒ‡ä»¤v-hasPermiå¦‚ä½•å†™</p><blockquote><p>æƒé™æ§åˆ¶</p></blockquote><h2 id="_1ã€å¸¸è§çš„æƒé™æ§åˆ¶åˆ†ç±»" tabindex="-1">1ã€å¸¸è§çš„æƒé™æ§åˆ¶åˆ†ç±» <a class="header-anchor" href="#_1ã€å¸¸è§çš„æƒé™æ§åˆ¶åˆ†ç±»" aria-label="Permalink to &quot;1ã€å¸¸è§çš„æƒé™æ§åˆ¶åˆ†ç±»&quot;">â€‹</a></h2><p>å¸¸è§çš„æƒé™æ§åˆ¶å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š</p><p>â— åŸºäº ACL çš„æƒé™æ§åˆ¶ â— åŸºäº RBAC çš„æƒé™æ§åˆ¶</p><h3 id="ğŸ‘‰acl" tabindex="-1">ğŸ‘‰ACL <a class="header-anchor" href="#ğŸ‘‰acl" aria-label="Permalink to &quot;ğŸ‘‰ACL&quot;">â€‹</a></h3><p>æ˜¯ç”¨æˆ· -&gt; æƒé™ï¼Œç›´æ¥ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…æƒé™</p><h3 id="ğŸ‘‰rbac-role-based-access-control-æ¨¡å‹" tabindex="-1">ğŸ‘‰RBAC ï¼ˆRole-Based Access Controlï¼‰æ¨¡å‹ <a class="header-anchor" href="#ğŸ‘‰rbac-role-based-access-control-æ¨¡å‹" aria-label="Permalink to &quot;ğŸ‘‰RBAC ï¼ˆRole-Based Access Controlï¼‰æ¨¡å‹&quot;">â€‹</a></h3><p>æ˜¯ç”¨æˆ· -&gt; è§’è‰² -&gt; æƒé™ï¼Œä»¥è§’è‰²ä¸ºåª’ä»‹ï¼Œæ¥ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…æƒé™</p><p>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨çš„ä¹Ÿæ˜¯ RBAC çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ç”¨æˆ·è§’è‰²æ¥æ§åˆ¶ç”¨æˆ·çš„æƒé™</p><h2 id="_2ã€æŒ‰é’®æƒé™" tabindex="-1">2ã€æŒ‰é’®æƒé™ <a class="header-anchor" href="#_2ã€æŒ‰é’®æƒé™" aria-label="Permalink to &quot;2ã€æŒ‰é’®æƒé™&quot;">â€‹</a></h2><h3 id="ğŸ”ºæƒé™æœºåˆ¶" tabindex="-1">ğŸ”ºæƒé™æœºåˆ¶ <a class="header-anchor" href="#ğŸ”ºæƒé™æœºåˆ¶" aria-label="Permalink to &quot;ğŸ”ºæƒé™æœºåˆ¶&quot;">â€‹</a></h3><p>æ­£å¸¸æˆ‘ä»¬çš„æƒé™æœºåˆ¶æ˜¯è¿™æ ·å­çš„ï¼š</p><blockquote><p>åå°ç»™æˆ‘ä»¬è¿”å›ç”¨æˆ·æƒé™ä¿¡æ¯permissions å‰ç«¯æ ¹æ®è¿”å›çš„æƒé™ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯å¦æœ‰æƒé™å±•ç¤ºæŒ‰é’® æŒ‰ç…§æƒé™ç”ŸæˆæŒ‰é’®</p></blockquote><h3 id="ğŸ‘‰å‘½ä»¤æ–¹å¼" tabindex="-1">ğŸ‘‰å‘½ä»¤æ–¹å¼ <a class="header-anchor" href="#ğŸ‘‰å‘½ä»¤æ–¹å¼" aria-label="Permalink to &quot;ğŸ‘‰å‘½ä»¤æ–¹å¼&quot;">â€‹</a></h3><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system:user:add&#39;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> ç³»ç»Ÿ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> æ¨¡å—</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> åŠŸèƒ½</span></span></code></pre></div><h3 id="ğŸ‘‰ä½¿ç”¨æ–¹å¼" tabindex="-1">ğŸ‘‰ä½¿ç”¨æ–¹å¼ <a class="header-anchor" href="#ğŸ‘‰ä½¿ç”¨æ–¹å¼" aria-label="Permalink to &quot;ğŸ‘‰ä½¿ç”¨æ–¹å¼&quot;">â€‹</a></h3><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åå°ç»™æˆ‘ä»¬è¿”å›çš„</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system:user:resetPwd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æƒé™åˆ—è¡¨</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‰ç«¯æŒ‰é’®æƒé™</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">el-button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-hasPermi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[&#39;system:user:add&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;æ–°å¢&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">el-button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="_3ã€æŒ‰é’®æƒé™æ­å»º" tabindex="-1">3ã€æŒ‰é’®æƒé™æ­å»º <a class="header-anchor" href="#_3ã€æŒ‰é’®æƒé™æ­å»º" aria-label="Permalink to &quot;3ã€æŒ‰é’®æƒé™æ­å»º&quot;">â€‹</a></h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ–°å»ºä¸€ä¸ªdirectiveæ–‡ä»¶å¤¹,åœ¨index.jsæ–‡ä»¶ä¹‹ä¸­å…ˆç®€å•å®ç°ä¸€ä¸‹æˆ‘ä»¬çš„æƒé™æŒ‡ä»¤</p><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// directives/index.js</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">binding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> binding</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> all_permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system:user:add&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//æƒé™åˆ—è¡¨</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¦‚æœ value æ˜¯æ•°ç»„ä¸”é•¿åº¦å¤§äº 0</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissionFlag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å…·æœ‰æŒ‡å®šçš„æƒé™</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hasPermission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all_permission.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissionFlag.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(permission)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        permissions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissionFlag.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(permission))</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å¦‚æœæ²¡æœ‰æƒé™ï¼Œç§»é™¤å…ƒç´ </span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hasPermission) {</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        el.parentNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> el.parentNode.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el)</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;need roles! Like v-hasPermi=&quot;[`system:user:add`]&quot;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ä¸Šé¢ä»£ç åœ¨è¿™ä¸ªè¿‡ç¨‹ä¹‹ä¸­åšäº†å“ªäº›äº‹æƒ…ï¼š</p><blockquote><p>ä»å…ƒç´ æŒ‚è½½å¼€å§‹ï¼Œåœ¨mountedç”Ÿå‘½å‘¨æœŸé’©å­ä¸­(el:è¢«ç»‘å®šçš„ DOM å…ƒç´ ,binding:åŒ…å«æŒ‡ä»¤ç›¸å…³ä¿¡æ¯çš„å¯¹è±¡,åé¢æˆ‘ä»¬æ‹¿çš„valueå€¼ï¼Œä¹Ÿå°±æ˜¯[&#39;system:user:add&#39;]è¿™ä¸ªå€¼)</p><p>åˆ¤æ–­[&#39;system:user:add&#39;]æ˜¯å¦ä¸ºæˆ‘ä»¬æƒ³è¦çš„æœ‰æ•ˆæ•°ç»„</p><p>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å…·æœ‰æŒ‡å®šçš„æƒé™</p><p>æ²¡æœ‰æƒé™çš„æ—¶å€™=&gt;el.parentNodeæ‹¿åˆ°çˆ¶å…ƒç´ èŠ‚ç‚¹=&gt;el.parentNode.removeChild(el)ç§»é™¤å…ƒç´ </p></blockquote><h3 id="ğŸ‘‰æƒé™æŒ‡ä»¤" tabindex="-1">ğŸ‘‰æƒé™æŒ‡ä»¤ <a class="header-anchor" href="#ğŸ‘‰æƒé™æŒ‡ä»¤" aria-label="Permalink to &quot;ğŸ‘‰æƒé™æŒ‡ä»¤&quot;">â€‹</a></h3><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// main.js</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hasPermi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/directive/hasPermi&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hasPermi&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,hasPermi);</span></span></code></pre></div><h3 id="ğŸ‘‰ä½¿ç”¨" tabindex="-1">ğŸ‘‰ä½¿ç”¨ <a class="header-anchor" href="#ğŸ‘‰ä½¿ç”¨" aria-label="Permalink to &quot;ğŸ‘‰ä½¿ç”¨&quot;">â€‹</a></h3><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">el-button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-hasPermi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[&#39;system:user:add&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;æ–°å¢&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">el-button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="ğŸ‘‰éªŒè¯æƒé™" tabindex="-1">ğŸ‘‰éªŒè¯æƒé™ <a class="header-anchor" href="#ğŸ‘‰éªŒè¯æƒé™" aria-label="Permalink to &quot;ğŸ‘‰éªŒè¯æƒé™&quot;">â€‹</a></h3><p>æ¥ä¸‹æ¥éªŒè¯ä¸€ä¸‹åˆšåˆšæˆ‘ä»¬å†™å¥½çš„æƒé™æŒ‰é’®,æƒé™å’ŒæŒ‰é’®åŒ¹é…å°±æ˜¾ç¤º,ä¸åŒ¹é…å°±éšè—</p><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system:user:add&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ˜¾ç¤ºæŒ‰é’®</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system:user:adds&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸æ˜¾ç¤ºæŒ‰é’®</span></span></code></pre></div><p>è¯æ˜æˆ‘ä»¬çš„æƒé™æŒ‰é’®æ²¡é—®é¢˜</p><h3 id="ğŸ‘‰åŠ¨æ€æƒé™" tabindex="-1">ğŸ‘‰åŠ¨æ€æƒé™ <a class="header-anchor" href="#ğŸ‘‰åŠ¨æ€æƒé™" aria-label="Permalink to &quot;ğŸ‘‰åŠ¨æ€æƒé™&quot;">â€‹</a></h3><p>ğŸ‘‰storeåŠ¨æ€æƒé™</p><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// store/getters.js</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getters</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state.user.permissions</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> getters</span></span></code></pre></div><p>ğŸ‘‰ä½¿ç”¨åŠ¨æ€æƒé™</p><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/store&#39;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.getters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.getters.permissions</span></span></code></pre></div><p>ğŸ‘‰ å¢åŠ æœ€é«˜æƒé™</p><p>å½“æƒé™ä¸º*çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„æŒ‰é’®</p><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hasPermi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">binding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> binding</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> all_permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æœ€é«˜æƒé™ï¼Œè¡¨ç¤ºæ‰€æœ‰æƒé™</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”¨æˆ·æ‹¥æœ‰çš„æƒé™åˆ—è¡¨ï¼Œå¯ä»¥åŠ¨æ€è®¾ç½®</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ£€æŸ¥æ˜¯å¦æœ‰æœ€é«˜æƒé™</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hasHighestPermission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æˆ–è€…ä½ å¯ä»¥æ£€æŸ¥æ˜¯å¦æœ‰ &#39;admin&#39; ç­‰æƒé™</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (hasHighestPermission) {</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å¦‚æœç”¨æˆ·æœ‰æœ€é«˜æƒé™ï¼Œåˆ™æ˜¾ç¤ºæ‰€æœ‰æŒ‰é’®</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å¦‚æœ value æ˜¯æ•°ç»„ä¸”é•¿åº¦å¤§äº 0</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> permissionFlag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å…·æœ‰æŒ‡å®šçš„æƒé™</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hasPermission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all_permission.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissionFlag.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(permission)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        permissions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissionFlag.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(permission));</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å¦‚æœæ²¡æœ‰æƒé™ï¼Œç§»é™¤å…ƒç´ </span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hasPermission) {</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        el.parentNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> el.parentNode.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el);</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;need roles! Like v-hasPermi=&quot;[`system:user:add`]&quot;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hasPermi;</span></span></code></pre></div><p>å¢åŠ æœ€é«˜æƒé™åï¼Œç®¡ç†å‘˜ä¸‹æ‰€æœ‰æŒ‰é’®å°±å¯ä»¥éƒ½æ˜¾ç¤ºäº†</p>',41)]))}]]);export{h as __pageData,l as default};
