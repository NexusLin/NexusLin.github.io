import{r as c,f as te,g as le,c as ae,a as h,b as t,l as _,v as L,h as l,i as r,j as Q,u as n,k as p,x,y as M,m as oe,E as ne,n as v,e as w}from"./index-B_mAkUH5.js";import{l as se,g as re,d as ie,u as ue,a as de}from"./chat-CCx4LQA3.js";import{u as ce}from"./user-C6RCANnn.js";import"./login-D_PYrTNz.js";const pe={class:"app-container"},me={class:"bcbox"},fe={class:"bcbox"},ge={class:"bcbox"},ve=["src"],_e={class:"dialog-footer"},xe={__name:"index",setup(be){const T=ce(),D=c([]),m=c(!1),V=c(!0),k=c(!0),I=c([]),P=c(!0),R=c(!0),S=c(0),B=c(""),$=te({form:{},queryParams:{pageNum:1,pageSize:10,noticeTitle:void 0,createBy:void 0,status:void 0},rules:{userId:[{required:!0,message:"ID不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"change"}]}}),{queryParams:s,form:i,rules:j}=le($);function f(){V.value=!0,se(s.value).then(a=>{D.value=a.data,S.value=a.total,V.value=!1})}function A(){m.value=!1,U()}function U(){i.value={status:"0",userId:0,userName:T.name,avatar:T.avatar,chatName:"群聊",receiverId:0,content:void 0,grade:0}}function C(){s.value.pageNum=1,f()}function F(){C()}function G(a){I.value=a.map(e=>e.id),P.value=a.length!=1,R.value=!a.length}function H(){U(),m.value=!0,B.value="添加公告"}function z(a){U();const e=a.chatId||I.value;re(e).then(u=>{i.value=u.data,m.value=!0,B.value="修改公告"})}const J=async()=>{try{if(i.value.chatId){const a=await ue(i.value);a.code==200?(v.success(a.message),m.value=!1,f()):v.error(a.message)}else{const a=await de(i.value);a.code==200?(v.success(a.message),m.value=!1,f()):v.error(a.message)}}catch{v.error("操作失败")}},E=async a=>{const e=a.chatId||I.value;ne.confirm('是否确认删除编号为"'+e+'"的数据项？',"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ie(e).then(u=>{u.code==200?(v.success(u.message),f()):v.error(u.message)})}).catch(()=>{})};return f(),(a,e)=>{const u=r("el-input"),b=r("el-form-item"),d=r("el-button"),q=r("el-form"),y=r("el-col"),O=r("RightToolbar"),K=r("el-row"),g=r("el-table-column"),W=r("el-table"),X=r("Pagination"),Y=r("el-dialog"),N=M("hasPermi"),Z=M("loading");return w(),ae("div",pe,[h("div",me,[_(t(q,{model:n(s),ref:"queryRef",inline:!0},{default:l(()=>[t(b,{label:"公告标题",prop:"noticeTitle"},{default:l(()=>[t(u,{modelValue:n(s).noticeTitle,"onUpdate:modelValue":e[0]||(e[0]=o=>n(s).noticeTitle=o),placeholder:"请输入公告标题",clearable:"",style:{width:"200px"},onKeyup:Q(C,["enter"])},null,8,["modelValue"])]),_:1}),t(b,{label:"操作人员",prop:"createBy"},{default:l(()=>[t(u,{modelValue:n(s).createBy,"onUpdate:modelValue":e[1]||(e[1]=o=>n(s).createBy=o),placeholder:"请输入操作人员",clearable:"",style:{width:"200px"},onKeyup:Q(C,["enter"])},null,8,["modelValue"])]),_:1}),t(b,null,{default:l(()=>[t(d,{type:"primary",icon:"Search",onClick:C},{default:l(()=>e[8]||(e[8]=[p("搜索")])),_:1}),t(d,{icon:"Refresh",onClick:F},{default:l(()=>e[9]||(e[9]=[p("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[L,k.value]])]),h("div",fe,[t(K,{gutter:10,class:"mb8"},{default:l(()=>[t(y,{span:1.5},{default:l(()=>[_((w(),x(d,{type:"primary",plain:"",icon:"Plus",onClick:H},{default:l(()=>e[10]||(e[10]=[p("新增")])),_:1})),[[N,["system:notice:add"]]])]),_:1}),t(y,{span:1.5},{default:l(()=>[t(d,{type:"success",plain:"",icon:"Edit",disabled:P.value,onClick:z},{default:l(()=>e[11]||(e[11]=[p("修改")])),_:1},8,["disabled"])]),_:1}),t(y,{span:1.5},{default:l(()=>[t(d,{type:"danger",plain:"",icon:"Delete",disabled:R.value,onClick:E},{default:l(()=>e[12]||(e[12]=[p("删除")])),_:1},8,["disabled"])]),_:1}),t(O,{showSearch:k.value,"onUpdate:showSearch":e[2]||(e[2]=o=>k.value=o),onQueryTable:f},null,8,["showSearch"])]),_:1})]),h("div",ge,[_((w(),x(W,{data:D.value,onSelectionChange:G,"max-height":"540"},{default:l(()=>[t(g,{type:"selection",width:"55",align:"center"}),t(g,{label:"ID",align:"center",prop:"chatId",width:"100"}),t(g,{label:"用户ID",align:"center",prop:"userId","show-overflow-tooltip":!0}),t(g,{label:"用户昵称",align:"center",prop:"userName","show-overflow-tooltip":!0}),t(g,{label:"用户头像",align:"center",prop:"avatar"},{default:l(o=>[h("img",{class:"tableimg",src:n(oe).baseURL+o.row.avatar,alt:""},null,8,ve)]),_:1}),t(g,{label:"内容",align:"center",prop:"content",width:"100"}),t(g,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(o=>[_((w(),x(d,{link:"",type:"primary",icon:"Edit",onClick:ee=>z(o.row)},{default:l(()=>e[13]||(e[13]=[p("修改")])),_:2},1032,["onClick"])),[[N,["system:notice:edit"]]]),_((w(),x(d,{link:"",type:"primary",icon:"Delete",onClick:ee=>E(o.row)},{default:l(()=>e[14]||(e[14]=[p("删除")])),_:2},1032,["onClick"])),[[N,["system:notice:remove"]]])]),_:1})]),_:1},8,["data"])),[[Z,V.value]]),_(t(X,{total:S.value,"current-page":n(s).pageNum,"onUpdate:currentPage":e[3]||(e[3]=o=>n(s).pageNum=o),"page-size":n(s).pageSize,"onUpdate:pageSize":e[4]||(e[4]=o=>n(s).pageSize=o),onPagination:f},null,8,["total","current-page","page-size"]),[[L,S.value>0]])]),t(Y,{title:B.value,modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=o=>m.value=o),width:"780px","append-to-body":""},{footer:l(()=>[h("div",_e,[t(d,{type:"primary",onClick:J},{default:l(()=>e[15]||(e[15]=[p("确 定")])),_:1}),t(d,{onClick:A},{default:l(()=>e[16]||(e[16]=[p("取 消")])),_:1})])]),default:l(()=>[t(q,{ref:"noticeRef",model:n(i),rules:n(j),"label-width":"80px"},{default:l(()=>[t(K,null,{default:l(()=>[t(y,{span:24},{default:l(()=>[t(b,{label:"用户ID",prop:"userId"},{default:l(()=>[t(u,{modelValue:n(i).userId,"onUpdate:modelValue":e[5]||(e[5]=o=>n(i).userId=o),placeholder:"请输入公告标题"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{span:24},{default:l(()=>[t(b,{label:"内容"},{default:l(()=>[t(u,{type:"textarea",modelValue:n(i).content,"onUpdate:modelValue":e[6]||(e[6]=o=>n(i).content=o),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}};export{xe as default};
