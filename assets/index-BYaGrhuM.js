import{s as w,z as j,r as s,f as G,g as H,o as J,c as I,a as v,b as t,h as a,i as u,u as o,k as V,l as K,m as W,v as X,F as Y,d as Z,n as b,e as x,x as ee}from"./index-B_mAkUH5.js";function te(m){return w({url:"/system/comments",method:"get",params:m})}function le(m){return w({url:"/system/comments",method:"post",data:m})}function ae(m){return w({url:"/system/comments",method:"put",data:m})}const oe={class:"compage page-articlelist"},ne={class:"bcbox"},se={class:"bcbox"},ue={class:"image-slot"},re={class:"dialog-footer",style:{"text-align":"center"}},de={__name:"index",setup(m){const{proxy:U}=j();U.$useRouter();const y=U.$useRoute(),C=s(),N=s([]),S=G({form:{title:"",type:"",content:""},queryParams:{pageNum:1,pageSize:10,name:"",age:"",sex:1,type:"",status:""},rules:{title:[{required:!0,message:"文章标题不能为空",trigger:"blur"}],content:[{required:!0,message:"文章内容不能为空",trigger:"blur"}],type:[{required:!0,message:"文章类型不能为空",trigger:"change"}]}}),{queryParams:i,form:n,rules:q}=H(S);s(null);const k=s([]),c=s(!1),D=s("");s(1),s(10),s(!1),s(!1),s(!1),s(!1);const P=s(!0),h=s(0);J(()=>{y.params&&y.params.articleId&&(i.value.articleId=y.params.articleId),R()});const B=async(p,e)=>{console.log(n.value,"form.value"),p&&await p.validate((f,d)=>{f?(n.value.status=e,console.log(n.value),n.value.id!=null?ae(n.value).then(r=>{r.code==200?b.success(r.message):b.error(r.message),c.value=!1,_()}):le(n.value).then(r=>{r.code==200?b.success(r.message):b.error(r.message),c.value=!1,_()})):console.log("error submit!",d)})};function R(){i.value.pageNum=1,_()}function _(){P.value=!0,te(i.value).then(p=>{k.value=p.data,h.value=p.total,P.value=!1})}return(p,e)=>{const f=u("el-input"),d=u("el-form-item"),r=u("el-button"),z=u("el-form"),g=u("el-table-column"),L=u("PictureRounded"),$=u("el-icon"),F=u("el-image"),M=u("el-table"),A=u("Pagination"),E=u("el-option"),O=u("el-select"),Q=u("ImageUpload"),T=u("el-dialog");return x(),I("div",oe,[v("div",ne,[t(z,{model:o(i),ref:"queryForm",inline:!0,"label-width":"70px"},{default:a(()=>[t(d,{label:"内容"},{default:a(()=>[t(f,{modelValue:o(i).content,"onUpdate:modelValue":e[0]||(e[0]=l=>o(i).content=l),placeholder:"请输入",clearable:"",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),t(d,null,{default:a(()=>[t(r,{type:"primary",icon:"Search",onClick:R},{default:a(()=>e[10]||(e[10]=[V("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),v("div",se,[t(M,{border:!1,data:k.value,stripe:"",style:{width:"100%"},"max-height":"540"},{default:a(()=>[t(g,{type:"selection",width:"80"}),t(g,{label:"ID",align:"center",prop:"id",width:"170"}),t(g,{label:"评论人",align:"center",prop:"author","show-overflow-tooltip":!0}),t(g,{label:"内容",align:"center",prop:"content","show-overflow-tooltip":!0,width:"300"}),t(g,{prop:"thumburl",label:"缩略图",width:"300"},{default:a(l=>[t(F,{style:{width:"50px",height:"50px"},src:o(W).baseURL+l.row.thumburl,fit:"contain"},{error:a(()=>[v("div",ue,[t($,null,{default:a(()=>[t(L)]),_:1})])]),_:2},1032,["src"])]),_:1})]),_:1},8,["data"]),K(t(A,{total:h.value,"current-page":o(i).pageNum,"onUpdate:currentPage":e[1]||(e[1]=l=>o(i).pageNum=l),"page-size":o(i).pageSize,"onUpdate:pageSize":e[2]||(e[2]=l=>o(i).pageSize=l),onPagination:_},null,8,["total","current-page","page-size"]),[[X,h.value>0]])]),t(T,{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=l=>c.value=l),title:D.value,width:"980px",class:"article",style:{padding:"10px 50px","margin-top":"8vh"},draggable:""},{footer:a(()=>[v("div",re,[t(r,{type:"primary",onClick:e[7]||(e[7]=l=>B(C.value,0))},{default:a(()=>e[11]||(e[11]=[V("确 认")])),_:1}),t(r,{onClick:e[8]||(e[8]=l=>c.value=!1)},{default:a(()=>e[12]||(e[12]=[V("取 消")])),_:1})])]),default:a(()=>[t(z,{ref_key:"formRef",ref:C,model:o(n),rules:o(q),"label-width":"100px"},{default:a(()=>[t(d,{label:"标题",prop:"title","label-position":"right"},{default:a(()=>[t(f,{modelValue:o(n).title,"onUpdate:modelValue":e[3]||(e[3]=l=>o(n).title=l),placeholder:"请输入",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"类型",prop:"type"},{default:a(()=>[t(O,{modelValue:o(n).type,"onUpdate:modelValue":e[4]||(e[4]=l=>o(n).type=l),clearable:"",placeholder:"请选择"},{default:a(()=>[(x(!0),I(Y,null,Z(N.value,l=>(x(),ee(E,{key:l.dictCode,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"内容",prop:"content"},{default:a(()=>[t(f,{modelValue:o(n).content,"onUpdate:modelValue":e[5]||(e[5]=l=>o(n).content=l),type:"textarea",clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(d,{label:"缩略图",prop:"thumburl"},{default:a(()=>[t(Q,{modelValue:o(n).thumburl,"onUpdate:modelValue":e[6]||(e[6]=l=>o(n).thumburl=l),limit:1},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{de as default};
