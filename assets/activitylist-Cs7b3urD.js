import{B as K,r as s,f as W,g as X,o as Y,c as D,a as V,b as t,h as a,u as i,i as r,l as Z,v as ee,F,d as N,k as v,n as m,E as te,q as le,e as _,x as P}from"./index-B_mAkUH5.js";import{l as ae}from"./openapi-4AEQGLKe.js";import{l as oe,u as ie,a as ne,d as se,g as ue}from"./activities-CgjWfV5g.js";const re={class:"compage page-articlelist"},de={class:"bcbox"},pe={class:"bcbox"},ce={class:"bcbox"},me={class:"dialog-footer",style:{"text-align":"center"}},_e=K({__name:"activitylist",setup(fe){le();const w=s(),x=s([]),S=W({form:{},queryParams:{pageNum:1,pageSize:10,activityType:""},rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],description:[{required:!0,message:"内容不能为空",trigger:"blur"}],activityType:[{required:!0,message:"类型不能为空",trigger:"change"}]}}),{queryParams:d,form:u,rules:z}=X(S),T=s([]),c=s(!1),k=s("");s(1),s(10),s(!1),s(!1),s(!1),s(!1);const A=s(!0),h=s(0);Y(()=>{U("activitytype"),B()});const L=async(o,e)=>{o&&await o.validate((p,b)=>{p?(u.value.status=e,u.value.id!=null?ie(u.value).then(n=>{n.code==200?m.success(n.message):m.error(n.message),c.value=!1,g()}):ne(u.value).then(n=>{n.code==200?m.success(n.message):m.error(n.message),c.value=!1,g()})):console.log("error submit!",b)})};function B(){d.value.pageNum=1,g()}function g(){A.value=!0,oe(d.value).then(o=>{T.value=o.data,h.value=o.total,A.value=!1})}function R(o){console.log(o),ue(o).then(e=>{e.code==200?(u.value=e.data,c.value=!0):m.error(e.message)})}function $(){I(w.value),U("activitytype"),c.value=!0,k.value="添加",console.log("新增")}function U(o){ae({dict_type:o}).then(e=>{console.log(e),x.value=e.data})}function E(o){k.value="修改",R(o.id)}const M=async o=>{const e=o.id||e.value;te.confirm("是否确认删除选中的数据项？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{se(e).then(p=>{p.code==200?(m.success(p.message),g()):m.error(p.message)})}).catch(()=>{})},I=o=>{o&&o.resetFields()};return(o,e)=>{const p=r("el-option"),b=r("el-select"),n=r("el-form-item"),C=r("el-input"),f=r("el-button"),q=r("el-form"),O=r("el-col"),Q=r("el-row"),y=r("el-table-column"),j=r("el-table"),G=r("Pagination"),H=r("el-dialog");return _(),D("div",re,[V("div",de,[t(q,{model:i(d),ref:"queryForm",inline:!0,"label-width":"70px"},{default:a(()=>[t(n,{label:"类型",prop:"activityType"},{default:a(()=>[t(b,{modelValue:i(d).activityType,"onUpdate:modelValue":e[0]||(e[0]=l=>i(d).activityType=l),clearable:"",placeholder:"请选择"},{default:a(()=>[(_(!0),D(F,null,N(x.value,l=>(_(),P(p,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"标题"},{default:a(()=>[t(C,{modelValue:i(d).title,"onUpdate:modelValue":e[1]||(e[1]=l=>i(d).title=l),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),t(n,null,{default:a(()=>[t(f,{type:"primary",icon:"Search",onClick:B},{default:a(()=>e[10]||(e[10]=[v("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),V("div",pe,[t(Q,{gutter:10,class:"mb8"},{default:a(()=>[t(O,{span:1.5},{default:a(()=>[t(f,{type:"primary",plain:"",icon:"Plus",onClick:$},{default:a(()=>e[11]||(e[11]=[v("新增")])),_:1})]),_:1})]),_:1})]),V("div",ce,[t(j,{border:!1,data:T.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(y,{type:"selection",width:"80"}),t(y,{label:"ID",align:"center",prop:"id",width:"170"}),t(y,{label:"标题",align:"center",prop:"title","show-overflow-tooltip":!0}),t(y,{label:"内容",align:"center",prop:"description","show-overflow-tooltip":!0,width:"300"}),t(y,{fixed:"right",label:"操作"},{default:a(l=>[t(f,{type:"success",plain:"",onClick:J=>E(l.row)},{default:a(()=>e[12]||(e[12]=[v("修改")])),_:2},1032,["onClick"]),t(f,{type:"danger",plain:"",onClick:J=>M(l.row)},{default:a(()=>e[13]||(e[13]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Z(t(G,{total:h.value,"current-page":i(d).pageNum,"onUpdate:currentPage":e[2]||(e[2]=l=>i(d).pageNum=l),"page-size":i(d).pageSize,"onUpdate:pageSize":e[3]||(e[3]=l=>i(d).pageSize=l),onPagination:g},null,8,["total","current-page","page-size"]),[[ee,h.value>0]])]),t(H,{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=l=>c.value=l),title:k.value,width:"980px",class:"article",style:{padding:"10px 50px","margin-top":"8vh"},draggable:""},{footer:a(()=>[V("div",me,[t(f,{onClick:e[7]||(e[7]=l=>c.value=!1)},{default:a(()=>e[14]||(e[14]=[v("取 消")])),_:1}),t(f,{type:"primary",onClick:e[8]||(e[8]=l=>L(w.value))},{default:a(()=>e[15]||(e[15]=[v("确认")])),_:1})])]),default:a(()=>[t(q,{ref_key:"ruleFormRef",ref:w,model:i(u),rules:i(z),"label-width":"100px"},{default:a(()=>[t(n,{label:"类型",prop:"activityType"},{default:a(()=>[t(b,{modelValue:i(u).activityType,"onUpdate:modelValue":e[4]||(e[4]=l=>i(u).activityType=l),clearable:"",placeholder:"请选择"},{default:a(()=>[(_(!0),D(F,null,N(x.value,l=>(_(),P(p,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"标题",prop:"title","label-position":"right"},{default:a(()=>[t(C,{modelValue:i(u).title,"onUpdate:modelValue":e[5]||(e[5]=l=>i(u).title=l),placeholder:"请输入",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(n,{label:"内容",prop:"description"},{default:a(()=>[t(C,{modelValue:i(u).description,"onUpdate:modelValue":e[6]||(e[6]=l=>i(u).description=l),type:"textarea",clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{_e as default};
