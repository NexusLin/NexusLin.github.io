import{s as h,B as ue,z as re,r as i,f as ie,g as de,o as ce,c as I,a as x,b as t,h as a,u as o,i as u,l as me,v as pe,F as T,d as E,k as f,m as fe,x as k,q as ge,n as g,E as F,e as V}from"./index-B_mAkUH5.js";import{l as ve}from"./openapi-4AEQGLKe.js";function _e(c){return h({url:"/system/articles",method:"get",params:c})}function be(c){return h({url:"/system/articles",method:"post",data:c})}function ye(c){return h({url:"/system/articles/"+c,method:"get"})}function Ve(c){return h({url:"/system/articles",method:"put",data:c})}function he(c){return h({url:"/system/articles/"+c,method:"delete"})}function xe(c,C){return h({url:"/system/articles/status/"+c,method:"put",data:C})}const we={class:"compage page-articlelist"},ke={class:"bcbox"},Ce={class:"bcbox"},Ue={class:"bcbox"},De={class:"image-slot"},$e={class:"dialog-footer",style:{"text-align":"center"}},Ie=ue({__name:"articlelist",setup(c){const{proxy:C}=re(),M=ge(),P=i(),U=i([]),O=ie({form:{title:"",type:"",content:""},queryParams:{pageNum:1,pageSize:10,name:"",age:"",sex:1,type:"",status:""},rules:{title:[{required:!0,message:"文章标题不能为空",trigger:"blur"}],content:[{required:!0,message:"文章内容不能为空",trigger:"blur"}],type:[{required:!1,message:"文章类型不能为空",trigger:"change"}]}}),{queryParams:d,form:s,rules:Q}=de(O);i(null);const S=i([]),v=i(!1),D=i("");i(1),i(10),i(!1),i(!1),i(!1),i(!1);const R=i(!0),$=i(0);ce(()=>{A(),q()});function j(n){console.log(n),console.log(`/commentlist/${n.articleId}`),M.push({path:`/commentlist/${n.articleId}`})}function A(){ve({dict_type:"nexus_articletype"}).then(n=>{U.value=n.data})}const G=async(n,e)=>{console.log(s.value,"form.value"),n&&await n.validate((p,r)=>{p?(s.value.status=e,console.log(s.value),s.value.articleId!=null?Ve(s.value).then(m=>{m.code==200?g.success(m.message):g.error(m.message),v.value=!1,_()}):be(s.value).then(m=>{m.code==200?g.success(m.message):g.error(m.message),v.value=!1,_()})):console.log("error submit!",r)})};function q(){d.value.pageNum=1,_()}function _(){R.value=!0,_e(d.value).then(n=>{S.value=n.data,$.value=n.total,R.value=!1})}function H(n){console.log(n),ye(n).then(e=>{e.code==200?(s.value=e.data,v.value=!0):g.error(e.message)})}function J(){A(),v.value=!0,X(),D.value="添加"}function K(n){D.value="修改",A(),H(n.articleId)}const W=async n=>{const e=n.articleId||e.value;F.confirm("是否确认删除选中的数据项？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{he(e).then(p=>{p.code==200?(g.success(p.message),_()):g.error(p.message)})}).catch(()=>{})};function z(n,e){let p=e=="1"?"启用":"停用";F.confirm(`确认要${p}吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{xe(n.id,{status:e}).then(function(r){r.code==200?(g.success(r.message),_()):(g.error(r.message),_())})}).catch(()=>{})}function X(){s.value={title:void 0,type:void 0,content:void 0},C.$resetForm("formRef")}return(n,e)=>{const p=u("el-input"),r=u("el-form-item"),m=u("el-option"),B=u("el-select"),b=u("el-button"),N=u("el-form"),Y=u("el-col"),Z=u("el-row"),y=u("el-table-column"),ee=u("PictureRounded"),te=u("el-icon"),le=u("el-image"),L=u("el-tag"),ae=u("el-table"),oe=u("Pagination"),ne=u("ImageUpload"),se=u("el-dialog");return V(),I("div",we,[x("div",ke,[t(N,{model:o(d),ref:"queryForm",inline:!0,"label-width":"70px"},{default:a(()=>[t(r,{label:"标题"},{default:a(()=>[t(p,{modelValue:o(d).title,"onUpdate:modelValue":e[0]||(e[0]=l=>o(d).title=l),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),t(r,{label:"类型"},{default:a(()=>[t(B,{modelValue:o(d).type,"onUpdate:modelValue":e[1]||(e[1]=l=>o(d).type=l),clearable:"",placeholder:"请选择"},{default:a(()=>[(V(!0),I(T,null,E(U.value,l=>(V(),k(m,{key:l.dictCode,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"状态"},{default:a(()=>[t(B,{modelValue:o(d).status,"onUpdate:modelValue":e[2]||(e[2]=l=>o(d).status=l),clearable:"",placeholder:"请选择"},{default:a(()=>[t(m,{label:"已发布",value:1}),t(m,{label:"未发布",value:0})]),_:1},8,["modelValue"])]),_:1}),t(r,null,{default:a(()=>[t(b,{type:"primary",icon:"Search",onClick:q},{default:a(()=>e[12]||(e[12]=[f("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),x("div",Ce,[t(Z,{gutter:10,class:"mb8"},{default:a(()=>[t(Y,{span:1.5},{default:a(()=>[t(b,{type:"primary",plain:"",icon:"Plus",onClick:J},{default:a(()=>e[13]||(e[13]=[f("新增")])),_:1})]),_:1})]),_:1})]),x("div",Ue,[t(ae,{border:!1,data:S.value,stripe:"",style:{width:"100%"},"max-height":"540"},{default:a(()=>[t(y,{type:"selection",width:"60"}),t(y,{label:"文章ID",align:"center",prop:"articleId"}),t(y,{label:"标题",align:"center",prop:"title","show-overflow-tooltip":!0}),t(y,{label:"内容",align:"center",prop:"content","show-overflow-tooltip":!0,width:"280"}),t(y,{prop:"thumburl",label:"缩略图"},{default:a(l=>[t(le,{style:{width:"50px",height:"50px"},src:o(fe).baseURL+l.row.thumburl,fit:"contain"},{error:a(()=>[x("div",De,[t(te,null,{default:a(()=>[t(ee)]),_:1})])]),_:2},1032,["src"])]),_:1}),t(y,{label:"状态",align:"center",key:"status"},{default:a(l=>[l.row.status==1?(V(),k(L,{key:0,style:{cursor:"pointer"},onClick:w=>z(l.row,0),type:"success"},{default:a(()=>e[14]||(e[14]=[f("去撤销")])),_:2},1032,["onClick"])):(V(),k(L,{key:1,style:{cursor:"pointer"},type:"primary",onClick:w=>z(l.row,1)},{default:a(()=>e[15]||(e[15]=[f("去通过")])),_:2},1032,["onClick"]))]),_:1}),t(y,{fixed:"right",label:"操作",width:"300"},{default:a(l=>[t(b,{type:"primary",onClick:w=>j(l.row)},{default:a(()=>e[16]||(e[16]=[f("查看评论")])),_:2},1032,["onClick"]),t(b,{type:"success",plain:"",onClick:w=>K(l.row)},{default:a(()=>e[17]||(e[17]=[f("修改")])),_:2},1032,["onClick"]),t(b,{type:"danger",plain:"",onClick:w=>W(l.row)},{default:a(()=>e[18]||(e[18]=[f("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),me(t(oe,{total:$.value,"current-page":o(d).pageNum,"onUpdate:currentPage":e[3]||(e[3]=l=>o(d).pageNum=l),"page-size":o(d).pageSize,"onUpdate:pageSize":e[4]||(e[4]=l=>o(d).pageSize=l),onPagination:_},null,8,["total","current-page","page-size"]),[[pe,$.value>0]])]),t(se,{modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=l=>v.value=l),title:D.value,width:"980px",class:"article",style:{padding:"10px 50px","margin-top":"8vh"},draggable:""},{footer:a(()=>[x("div",$e,[t(b,{type:"primary",onClick:e[9]||(e[9]=l=>G(P.value,0))},{default:a(()=>e[19]||(e[19]=[f("确 认")])),_:1}),t(b,{onClick:e[10]||(e[10]=l=>v.value=!1)},{default:a(()=>e[20]||(e[20]=[f("取 消")])),_:1})])]),default:a(()=>[t(N,{ref_key:"formRef",ref:P,model:o(s),rules:o(Q),"label-width":"100px"},{default:a(()=>[t(r,{label:"标题",prop:"title","label-position":"right"},{default:a(()=>[t(p,{modelValue:o(s).title,"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).title=l),placeholder:"请输入",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(r,{label:"类型",prop:"type"},{default:a(()=>[t(B,{modelValue:o(s).type,"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).type=l),clearable:"",placeholder:"请选择"},{default:a(()=>[(V(!0),I(T,null,E(U.value,l=>(V(),k(m,{key:l.dictCode,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"内容",prop:"content"},{default:a(()=>[t(p,{modelValue:o(s).content,"onUpdate:modelValue":e[7]||(e[7]=l=>o(s).content=l),type:"textarea",clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(r,{label:"缩略图",prop:"thumburl"},{default:a(()=>[t(ne,{modelValue:o(s).thumburl,"onUpdate:modelValue":e[8]||(e[8]=l=>o(s).thumburl=l),limit:1},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ie as default};
